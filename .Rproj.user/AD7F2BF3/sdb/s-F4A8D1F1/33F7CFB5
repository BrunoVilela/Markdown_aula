{
    "contents" : "library(maptools)\nlibrary(\"splancs\")\n\n#################################################################\nteste2<-readShapePoly(\"G:/Bruno - pcDocumentos/Doutorado/Mamiferos/MamÃ­feros ranges/Abditomys_latidens.shp\")\npoligono<-teste2@polygons[[5]]@Polygons[[1]]@coords\nplot(teste2@polygons[[1]]@Polygons[[1]]@coords,xlim=c(120,122),ylim=c(13,18),type='n',xlab=\"longitude\",ylab=\"latitude\")\npolygon(teste2@polygons[[1]]@Polygons[[1]]@coords)\npolygon(teste2@polygons[[2]]@Polygons[[1]]@coords)\npolygon(teste2@polygons[[3]]@Polygons[[1]]@coords)\npolygon(teste2@polygons[[4]]@Polygons[[1]]@coords)\npolygon(teste2@polygons[[5]]@Polygons[[1]]@coords)\npolygon(teste2@polygons[[6]]@Polygons[[1]]@coords)\n\n################################################################\ngrid<-function(minx=0,maxx=0,miny=0,maxy=0,escala=0.05,data=0){\nif (!is.numeric(data)){\ndata<-data@bbox  \nminx<-floor(data[1])\nminy<-floor(data[2])\nmaxx<-ceiling(data[3])\nmaxy<-ceiling(data[4])\n}                              \ngrid1<-seq(maxy,miny,-escala)\ngrid2<-seq(minx,maxx,escala)\ngridx<-rep(grid2,length(grid1))\ngridy<-rep(grid1,each=length(grid2))\nreturn((cbind(gridx,gridy)))\n}\n###################################\ngrid34<-grid(data=teste2,escala=0.05)\npoints(grid34[,1],grid34[,2],cex=0.2)\n\ngrid35<-grid(120,122,13,18,0.05)\npoints(grid35[,1],grid35[,2],cex=0.2)\n\n####################################\ntrabalho<-function(poligono,grid,names=FALSE){\nn<-nrow(grid)\nmatriz<-matrix(0,n)\nfor(j in 1:n){\n    ponto<-matrix(grid[j,],ncol=2)  \n    matriz[j]<-ifelse(inout(ponto,poligono,bound=TRUE),1,0)\n    }\na<-table(grid)\nb<-length(a)\n\nmatriz2<-matrix(0)\nfor(i in 1:(n-a[1]-1)){\nmatriz2[i]<-ifelse(sum(matriz[i,],matriz[i+1,],matriz[i+a[1],],matriz[i+a[1]+1,])>0,1,0)  \n}\n\ngrid2<-matrix(0,ncol=2,nrow=(n-a[1]-1))\nfor(h in 1:(n-a[1]-1)){\n  grid2[h,1]<-sum(grid[h:(h+1),1],grid[(h+a[1]):(h+a[1]+1),1])/4\n  grid2[h,2]<-sum(grid[h:(h+1),2],grid[(h+a[1]):(h+a[1]+1),2])/4\n}\ngrid2<-grid2\n\ngrid3<-grid2[-seq(a[1],length(matriz2)-(a[1]-2),a[1]),]\nmatriz3<-matriz2[-seq(a[1],length(matriz2)-(a[1]-2),a[1])]\nmatriz3<-as.matrix(matriz3,ncol=1)\nresu<-(matriz3)\nresu<-cbind(grid3,matriz3)\nif(names==TRUE){\n  nomes<-c(\"x\",\"y\",\"sp1\")\n  colnames(resu)<-nomes\n}\nreturn(resu)\n}\n###############################################\n\ntrabalho(poligono,grid35)\nhead(trabalho(poligono,grid35))\nhead(trabalho(poligono,grid35,names=TRUE))\ncentro<-trabalho(poligono,grid35)\npoints(centro[,1],centro[,2],cex=0.2,col=\"red\",pch=\"C\")\n\n####Ainda em testes!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!#############################################################\n##nome1<-as.vector(teste2@data[1,1])\n\nretirar<-function(arquivo,grid=as.data.frame(0)){\n  if(!is.matrix(grid)){\n    grid<-grid(data=arquivo)}  \n  Data<<-nrow(teste2@data)\n  a<<-table(grid)\n  a1<<-length(a)\n  n<<-nrow(grid)\n  linhas<<-as.vector(n-a[1])-(a[a1]-1)\n  resu<-matrix(0,nrow=linhas,ncol=Data+2)\n  for(i in 1:Data){\n    dados<-arquivo@polygons[[i]]@Polygons[[1]]@coords\n    res<-trabalho(dados,grid)\n    if(i==1){resu[,1:3]<-res}\n    else{resu[,i+2]<-res[,3]      \n    }}\n  nome1<-as.vector(arquivo@data[,1])\n  nomes<-c(\"longitude\",\"latitude\",nome1)\n  colnames(resu)<-nomes\n  \n  return(resu)\n}\n####################################################\nretirar(teste2)->resultado\nresultado\nhead(resultado)\n\n\n###############################################\n\nunicas<-function(resultado){\nn<-ncol(resultado)  \nresu<-resultado\nnomes<<-colnames(resultado)\nfor(i in 1:(n-1)){  \n  nome1<-nomes[i]\n  for(j in 1:n){\n    nome2<-nomes[j]    \n    if(nome1==nome2){\n    resu[,i]<-resu[,i]+resu[,j]\n    }}}\ny<-ncol(resu)\nresu[,3:y]<-ifelse(resu[,3:y]>0,1,0)\nt<-colSums(resu)\nfor(k in 1:(n-1)){\n  nome3<-nomes[k]\n  for(l in 1:n){\nnome4<-nomes[l]\nif(nome3==nome4 & k!=l & k>l){\n    resu<-resu[,-l]    \n}}}\nreturn(resu)\n}\n#######\nunicas(resultado)->voila\nhead(voila)\n\n###################################FINAL###############################################\n\nShapetransformator1.0<-function(arquivo,grid=as.data.frame(0)){\n  if(!is.matrix(grid)){\n    grid<-grid(data=arquivo)}  \n  Data<<-nrow(teste2@data)\n  a<<-table(grid)\n  a1<<-length(a)\n  n<<-nrow(grid)\n  linhas<<-as.vector(n-a[1])-(a[a1]-1)\n  resu<-matrix(0,nrow=linhas,ncol=Data+2)\n  for(i in 1:Data){\n    dados<-arquivo@polygons[[i]]@Polygons[[1]]@coords\n    res<-trabalho(dados,grid)\n    if(i==1){resu[,1:3]<-res}\n    else{resu[,i+2]<-res[,3]      \n    }}\n  nome1<-as.vector(arquivo@data[,1])\n  nomes<-c(\"longitude\",\"latitude\",nome1)\n  colnames(resu)<-nomes\n  resu<-unicas(resu)\n  resu[,1]<-resu[,1]/2\n  resu[,2]<-resu[,2]/2\n  \n  return(resu)\n}\nFINAL<-Shapetransformator1.0(teste2)\nhead(FINAL)\n\n",
    "created" : 1440621266122.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1414087598",
    "id" : "33F7CFB5",
    "lastKnownWriteTime" : 1355176362,
    "path" : "~/Bruno - pcDocumentos/Doutorado/Disciplinas/R/Curso R/Trabalho.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 7,
    "source_on_save" : false,
    "type" : "r_source"
}